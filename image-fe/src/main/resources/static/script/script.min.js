var app=angular.module("filterSpecial",["ngMaterial","ngMessages","material.svgAssetsCache"]);app.directive("fileModel",["$parse",function(a){return{restrict:"A",link:function(b,c,d){var e=a(d.fileModel),f=e.assign;c.bind("change",function(){b.$apply(function(){f(b,c[0].files[0])})})}}}]),app.service("fileUpload",["$http",function(a){this.uploadFileToUrl=function(b,c,d,e,f){var g=new FormData;g.append("file",b),g.append("name",c),g.append("tag",d),a.put(e,g,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).success(function(a){console.log(a),f(a)}).error(function(a){console.log(a)})}}]),app.controller("filterCtrl",["$scope","fileUpload","$mdDialog","$http",function(a,b,c,d){function e(a,b){a.hide=function(){b.hide()},a.cancel=function(){b.cancel()},a.answer=function(a){b.hide(a)}}e.$inject=["$scope","$mdDialog"],a.startsWith=function(a,b){var c=(a+"").toLowerCase();return 0===c.indexOf(b.toLowerCase())},a.getTagsForInitImages=function(){for(i=0;i<a.images.length;i++)a.getTags(i)},a.getTags=function(b){d.get("http://localhost:5000/tags/image/"+a.images[b].id).success(function(c){a.images[b].tags=c}).error(function(a){console.log(a)})},a.getTagsForImageWithId=function(a,b){d.get("http://localhost:5000/tags/image/"+a).success(function(a){b(a)}).error(function(a){console.log(a)})},a.getAllImages=function(){d.get("http://localhost:5000/images/").success(function(b){a.images=b,a.getTagsForInitImages()})},a.uploadFile=function(){var c="http://localhost:5000/image";console.log(c);var d=a.myFile;console.log("file is "),console.dir(d),b.uploadFileToUrl(d,a.name,a.tag,c,function(b){a.getTagsForImageWithId(b.id,function(c){b.tags=c,a.images.push(b)})})},a.deleteImage=function(b){d.post("http://localhost:5000/delete/"+b).success(function(){var c=a.images.map(function(a){return a.id}).indexOf(b);images.slice(c,1)}).error(function(a){console.log(a)})},a.showAdvanced=function(a,b,d,f){c.show({controller:e,template:'<img src="http://localhost:5000/image/'+b+'/png" ></img> <p style="margin:3px">Name: '+d+'</p><p style="margin:5px">Tags: '+f.toString()+"</p>",parent:angular.element(document.body),targetEvent:a,clickOutsideToClose:!0})}}]);